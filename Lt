using OpenQA.Selenium;
using OpenQA.Selenium.Remote;
using OpenQA.Selenium.Chrome;

class Program
{
    static void Main(string[] args)
    {
        string username = Environment.GetEnvironmentVariable("LT_USERNAME") ?? "<your-username>";
        string accessKey = Environment.GetEnvironmentVariable("LT_ACCESS_KEY") ?? "<your-access-key>";

        var ltOptions = new Dictionary<string, object>
        {
            { "user", username },
            { "accessKey", accessKey },
            { "build", "C# Selenium Build" },
            { "project", "C# LambdaTest Demo" },
            { "name", "Sample LambdaTest Test" },
            { "platformName", "Windows 11" },
            { "browserName", "Chrome" },
            { "browserVersion", "latest" },
            { "selenium_version", "4.20.0" }
        };

        var options = new ChromeOptions();
        options.AddAdditionalOption("LT:Options", ltOptions);

        try
        {
            using var driver = new RemoteWebDriver(
                new Uri("https://hub.lambdatest.com/wd/hub"), options
            );

            driver.Navigate().GoToUrl("https://example.com");
            Console.WriteLine("Title: " + driver.Title);
        }
        catch (WebDriverException ex)
        {
            Console.WriteLine("WebDriver error: " + ex.Message);
        }
    }
}
